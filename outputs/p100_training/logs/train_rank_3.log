[Rank 3] 2025-09-07 14:24:29,254 - root - INFO - Creating datasets...
[Rank 3] 2025-09-07 14:24:29,597 - mamba_training.data.dataset_processor - INFO - Initialized DatasetProcessor with tokenizer vocab size: 50257
[Rank 3] 2025-09-07 14:24:29,598 - mamba_training.data.dataset_processor - INFO - Processing dataset: data/train.txt
[Rank 3] 2025-09-07 14:24:43,721 - mamba_training.data.dataset_processor - INFO - Processed 10000/1165029 samples, kept 9622 after filtering
[Rank 3] 2025-09-07 14:24:47,620 - mamba_training.data.dataset_processor - INFO - Processed 20000/1165029 samples, kept 19231 after filtering
[Rank 3] 2025-09-07 14:24:51,571 - mamba_training.data.dataset_processor - INFO - Processed 30000/1165029 samples, kept 28968 after filtering
[Rank 3] 2025-09-07 14:24:54,815 - mamba_training.data.dataset_processor - INFO - Processed 40000/1165029 samples, kept 38465 after filtering
[Rank 3] 2025-09-07 14:24:58,682 - mamba_training.data.dataset_processor - INFO - Processed 50000/1165029 samples, kept 48076 after filtering
[Rank 3] 2025-09-07 14:25:02,175 - mamba_training.data.dataset_processor - INFO - Processed 60000/1165029 samples, kept 57640 after filtering
[Rank 3] 2025-09-07 14:25:05,710 - mamba_training.data.dataset_processor - INFO - Processed 70000/1165029 samples, kept 67228 after filtering
[Rank 3] 2025-09-07 14:25:09,824 - mamba_training.data.dataset_processor - INFO - Processed 80000/1165029 samples, kept 76793 after filtering
[Rank 3] 2025-09-07 14:25:13,244 - mamba_training.data.dataset_processor - INFO - Processed 90000/1165029 samples, kept 86394 after filtering
[Rank 3] 2025-09-07 14:25:16,829 - mamba_training.data.dataset_processor - INFO - Processed 100000/1165029 samples, kept 95979 after filtering
[Rank 3] 2025-09-07 14:25:20,361 - mamba_training.data.dataset_processor - INFO - Processed 110000/1165029 samples, kept 105635 after filtering
[Rank 3] 2025-09-07 14:25:24,941 - mamba_training.data.dataset_processor - INFO - Processed 120000/1165029 samples, kept 115334 after filtering
[Rank 3] 2025-09-07 14:25:28,504 - mamba_training.data.dataset_processor - INFO - Processed 130000/1165029 samples, kept 124870 after filtering
[Rank 3] 2025-09-07 14:25:32,247 - mamba_training.data.dataset_processor - INFO - Processed 140000/1165029 samples, kept 134494 after filtering
[Rank 3] 2025-09-07 14:25:36,036 - mamba_training.data.dataset_processor - INFO - Processed 150000/1165029 samples, kept 144193 after filtering
[Rank 3] 2025-09-07 14:25:40,475 - mamba_training.data.dataset_processor - INFO - Processed 160000/1165029 samples, kept 153750 after filtering
[Rank 3] 2025-09-07 14:25:44,122 - mamba_training.data.dataset_processor - INFO - Processed 170000/1165029 samples, kept 163318 after filtering
[Rank 3] 2025-09-07 14:25:47,881 - mamba_training.data.dataset_processor - INFO - Processed 180000/1165029 samples, kept 173033 after filtering
[Rank 3] 2025-09-07 14:25:51,612 - mamba_training.data.dataset_processor - INFO - Processed 190000/1165029 samples, kept 182666 after filtering
[Rank 3] 2025-09-07 14:25:55,324 - mamba_training.data.dataset_processor - INFO - Processed 200000/1165029 samples, kept 192236 after filtering
[Rank 3] 2025-09-07 14:26:00,133 - mamba_training.data.dataset_processor - INFO - Processed 210000/1165029 samples, kept 201736 after filtering
[Rank 3] 2025-09-07 14:26:03,927 - mamba_training.data.dataset_processor - INFO - Processed 220000/1165029 samples, kept 211399 after filtering
[Rank 3] 2025-09-07 14:26:07,731 - mamba_training.data.dataset_processor - INFO - Processed 230000/1165029 samples, kept 220981 after filtering
[Rank 3] 2025-09-07 14:26:11,543 - mamba_training.data.dataset_processor - INFO - Processed 240000/1165029 samples, kept 230594 after filtering
[Rank 3] 2025-09-07 14:26:15,428 - mamba_training.data.dataset_processor - INFO - Processed 250000/1165029 samples, kept 240303 after filtering
[Rank 3] 2025-09-07 14:26:19,278 - mamba_training.data.dataset_processor - INFO - Processed 260000/1165029 samples, kept 249958 after filtering
[Rank 3] 2025-09-07 14:26:23,452 - mamba_training.data.dataset_processor - INFO - Processed 270000/1165029 samples, kept 259684 after filtering
[Rank 3] 2025-09-07 14:26:28,428 - mamba_training.data.dataset_processor - INFO - Processed 280000/1165029 samples, kept 269253 after filtering
[Rank 3] 2025-09-07 14:26:32,477 - mamba_training.data.dataset_processor - INFO - Processed 290000/1165029 samples, kept 278985 after filtering
[Rank 3] 2025-09-07 14:26:36,465 - mamba_training.data.dataset_processor - INFO - Processed 300000/1165029 samples, kept 288595 after filtering
[Rank 3] 2025-09-07 14:26:40,391 - mamba_training.data.dataset_processor - INFO - Processed 310000/1165029 samples, kept 298307 after filtering
[Rank 3] 2025-09-07 14:26:44,294 - mamba_training.data.dataset_processor - INFO - Processed 320000/1165029 samples, kept 307919 after filtering
[Rank 3] 2025-09-07 14:26:48,192 - mamba_training.data.dataset_processor - INFO - Processed 330000/1165029 samples, kept 317462 after filtering
[Rank 3] 2025-09-07 14:26:52,106 - mamba_training.data.dataset_processor - INFO - Processed 340000/1165029 samples, kept 327094 after filtering
[Rank 3] 2025-09-07 14:26:56,080 - mamba_training.data.dataset_processor - INFO - Processed 350000/1165029 samples, kept 336748 after filtering
[Rank 3] 2025-09-07 14:27:01,304 - mamba_training.data.dataset_processor - INFO - Processed 360000/1165029 samples, kept 346382 after filtering
[Rank 3] 2025-09-07 14:27:05,368 - mamba_training.data.dataset_processor - INFO - Processed 370000/1165029 samples, kept 355986 after filtering
[Rank 3] 2025-09-07 14:27:09,423 - mamba_training.data.dataset_processor - INFO - Processed 380000/1165029 samples, kept 365573 after filtering
[Rank 3] 2025-09-07 14:27:13,493 - mamba_training.data.dataset_processor - INFO - Processed 390000/1165029 samples, kept 375162 after filtering
[Rank 3] 2025-09-07 14:27:17,432 - mamba_training.data.dataset_processor - INFO - Processed 400000/1165029 samples, kept 384871 after filtering
[Rank 3] 2025-09-07 14:27:21,182 - mamba_training.data.dataset_processor - INFO - Processed 410000/1165029 samples, kept 394482 after filtering
[Rank 3] 2025-09-07 14:27:25,206 - mamba_training.data.dataset_processor - INFO - Processed 420000/1165029 samples, kept 404082 after filtering
[Rank 3] 2025-09-07 14:27:29,184 - mamba_training.data.dataset_processor - INFO - Processed 430000/1165029 samples, kept 413708 after filtering
[Rank 3] 2025-09-07 14:27:33,135 - mamba_training.data.dataset_processor - INFO - Processed 440000/1165029 samples, kept 423368 after filtering
[Rank 3] 2025-09-07 14:27:37,297 - mamba_training.data.dataset_processor - INFO - Processed 450000/1165029 samples, kept 433059 after filtering
[Rank 3] 2025-09-07 14:27:41,416 - mamba_training.data.dataset_processor - INFO - Processed 460000/1165029 samples, kept 442746 after filtering
[Rank 3] 2025-09-07 14:27:47,032 - mamba_training.data.dataset_processor - INFO - Processed 470000/1165029 samples, kept 452463 after filtering
[Rank 3] 2025-09-07 14:27:50,949 - mamba_training.data.dataset_processor - INFO - Processed 480000/1165029 samples, kept 462035 after filtering
[Rank 3] 2025-09-07 14:27:55,122 - mamba_training.data.dataset_processor - INFO - Processed 490000/1165029 samples, kept 471662 after filtering
[Rank 3] 2025-09-07 14:27:59,333 - mamba_training.data.dataset_processor - INFO - Processed 500000/1165029 samples, kept 481361 after filtering
[Rank 3] 2025-09-07 14:28:03,528 - mamba_training.data.dataset_processor - INFO - Processed 510000/1165029 samples, kept 490932 after filtering
[Rank 3] 2025-09-07 14:28:07,804 - mamba_training.data.dataset_processor - INFO - Processed 520000/1165029 samples, kept 500606 after filtering
[Rank 3] 2025-09-07 14:28:11,891 - mamba_training.data.dataset_processor - INFO - Processed 530000/1165029 samples, kept 510144 after filtering
[Rank 3] 2025-09-07 14:28:16,112 - mamba_training.data.dataset_processor - INFO - Processed 540000/1165029 samples, kept 519767 after filtering
[Rank 3] 2025-09-07 14:28:20,338 - mamba_training.data.dataset_processor - INFO - Processed 550000/1165029 samples, kept 529444 after filtering
[Rank 3] 2025-09-07 14:28:24,525 - mamba_training.data.dataset_processor - INFO - Processed 560000/1165029 samples, kept 539176 after filtering
[Rank 3] 2025-09-07 14:28:28,623 - mamba_training.data.dataset_processor - INFO - Processed 570000/1165029 samples, kept 548802 after filtering
[Rank 3] 2025-09-07 14:28:32,825 - mamba_training.data.dataset_processor - INFO - Processed 580000/1165029 samples, kept 558421 after filtering
[Rank 3] 2025-09-07 14:28:39,164 - mamba_training.data.dataset_processor - INFO - Processed 590000/1165029 samples, kept 568107 after filtering
[Rank 3] 2025-09-07 14:28:43,245 - mamba_training.data.dataset_processor - INFO - Processed 600000/1165029 samples, kept 577706 after filtering
[Rank 3] 2025-09-07 14:28:47,525 - mamba_training.data.dataset_processor - INFO - Processed 610000/1165029 samples, kept 587413 after filtering
[Rank 3] 2025-09-07 14:28:51,543 - mamba_training.data.dataset_processor - INFO - Processed 620000/1165029 samples, kept 597049 after filtering
[Rank 3] 2025-09-07 14:28:55,611 - mamba_training.data.dataset_processor - INFO - Processed 630000/1165029 samples, kept 606630 after filtering
[Rank 3] 2025-09-07 14:28:59,914 - mamba_training.data.dataset_processor - INFO - Processed 640000/1165029 samples, kept 616299 after filtering
[Rank 3] 2025-09-07 14:29:04,075 - mamba_training.data.dataset_processor - INFO - Processed 650000/1165029 samples, kept 625979 after filtering
[Rank 3] 2025-09-07 14:29:08,283 - mamba_training.data.dataset_processor - INFO - Processed 660000/1165029 samples, kept 635616 after filtering
[Rank 3] 2025-09-07 14:29:12,543 - mamba_training.data.dataset_processor - INFO - Processed 670000/1165029 samples, kept 645220 after filtering
[Rank 3] 2025-09-07 14:29:16,683 - mamba_training.data.dataset_processor - INFO - Processed 680000/1165029 samples, kept 654810 after filtering
[Rank 3] 2025-09-07 14:29:20,763 - mamba_training.data.dataset_processor - INFO - Processed 690000/1165029 samples, kept 664376 after filtering
[Rank 3] 2025-09-07 14:29:24,963 - mamba_training.data.dataset_processor - INFO - Processed 700000/1165029 samples, kept 673978 after filtering
[Rank 3] 2025-09-07 14:29:29,232 - mamba_training.data.dataset_processor - INFO - Processed 710000/1165029 samples, kept 683595 after filtering
[Rank 3] 2025-09-07 14:29:33,387 - mamba_training.data.dataset_processor - INFO - Processed 720000/1165029 samples, kept 693245 after filtering
[Rank 3] 2025-09-07 14:29:37,558 - mamba_training.data.dataset_processor - INFO - Processed 730000/1165029 samples, kept 702933 after filtering
[Rank 3] 2025-09-07 14:29:41,895 - mamba_training.data.dataset_processor - INFO - Processed 740000/1165029 samples, kept 712617 after filtering
[Rank 3] 2025-09-07 14:29:46,358 - mamba_training.data.dataset_processor - INFO - Processed 750000/1165029 samples, kept 722325 after filtering
[Rank 3] 2025-09-07 14:29:53,054 - mamba_training.data.dataset_processor - INFO - Processed 760000/1165029 samples, kept 731886 after filtering
[Rank 3] 2025-09-07 14:29:57,521 - mamba_training.data.dataset_processor - INFO - Processed 770000/1165029 samples, kept 741563 after filtering
[Rank 3] 2025-09-07 14:30:01,733 - mamba_training.data.dataset_processor - INFO - Processed 780000/1165029 samples, kept 751172 after filtering
[Rank 3] 2025-09-07 14:30:05,932 - mamba_training.data.dataset_processor - INFO - Processed 790000/1165029 samples, kept 760827 after filtering
[Rank 3] 2025-09-07 14:30:10,159 - mamba_training.data.dataset_processor - INFO - Processed 800000/1165029 samples, kept 770488 after filtering
[Rank 3] 2025-09-07 14:30:14,509 - mamba_training.data.dataset_processor - INFO - Processed 810000/1165029 samples, kept 780084 after filtering
[Rank 3] 2025-09-07 14:30:18,584 - mamba_training.data.dataset_processor - INFO - Processed 820000/1165029 samples, kept 789704 after filtering
[Rank 3] 2025-09-07 14:30:22,862 - mamba_training.data.dataset_processor - INFO - Processed 830000/1165029 samples, kept 799332 after filtering
[Rank 3] 2025-09-07 14:30:27,090 - mamba_training.data.dataset_processor - INFO - Processed 840000/1165029 samples, kept 808962 after filtering
[Rank 3] 2025-09-07 14:30:31,382 - mamba_training.data.dataset_processor - INFO - Processed 850000/1165029 samples, kept 818600 after filtering
[Rank 3] 2025-09-07 14:30:35,576 - mamba_training.data.dataset_processor - INFO - Processed 860000/1165029 samples, kept 828238 after filtering
[Rank 3] 2025-09-07 14:30:39,841 - mamba_training.data.dataset_processor - INFO - Processed 870000/1165029 samples, kept 837922 after filtering
[Rank 3] 2025-09-07 14:30:44,301 - mamba_training.data.dataset_processor - INFO - Processed 880000/1165029 samples, kept 847636 after filtering
[Rank 3] 2025-09-07 14:30:48,869 - mamba_training.data.dataset_processor - INFO - Processed 890000/1165029 samples, kept 857288 after filtering
[Rank 3] 2025-09-07 14:30:53,327 - mamba_training.data.dataset_processor - INFO - Processed 900000/1165029 samples, kept 866875 after filtering
[Rank 3] 2025-09-07 14:30:57,696 - mamba_training.data.dataset_processor - INFO - Processed 910000/1165029 samples, kept 876486 after filtering
[Rank 3] 2025-09-07 14:31:02,034 - mamba_training.data.dataset_processor - INFO - Processed 920000/1165029 samples, kept 886110 after filtering
[Rank 3] 2025-09-07 14:31:06,277 - mamba_training.data.dataset_processor - INFO - Processed 930000/1165029 samples, kept 895602 after filtering
[Rank 3] 2025-09-07 14:31:10,669 - mamba_training.data.dataset_processor - INFO - Processed 940000/1165029 samples, kept 905266 after filtering
[Rank 3] 2025-09-07 14:31:15,230 - mamba_training.data.dataset_processor - INFO - Processed 950000/1165029 samples, kept 914889 after filtering
[Rank 3] 2025-09-07 14:31:22,825 - mamba_training.data.dataset_processor - INFO - Processed 960000/1165029 samples, kept 924532 after filtering
[Rank 3] 2025-09-07 14:31:27,189 - mamba_training.data.dataset_processor - INFO - Processed 970000/1165029 samples, kept 934151 after filtering
[Rank 3] 2025-09-07 14:31:31,632 - mamba_training.data.dataset_processor - INFO - Processed 980000/1165029 samples, kept 943783 after filtering
[Rank 3] 2025-09-07 14:31:36,260 - mamba_training.data.dataset_processor - INFO - Processed 990000/1165029 samples, kept 953434 after filtering
[Rank 3] 2025-09-07 14:31:40,335 - mamba_training.data.dataset_processor - INFO - Processed 1000000/1165029 samples, kept 963005 after filtering
[Rank 3] 2025-09-07 14:31:44,628 - mamba_training.data.dataset_processor - INFO - Processed 1010000/1165029 samples, kept 972675 after filtering
[Rank 3] 2025-09-07 14:31:48,926 - mamba_training.data.dataset_processor - INFO - Processed 1020000/1165029 samples, kept 982298 after filtering
[Rank 3] 2025-09-07 14:31:53,259 - mamba_training.data.dataset_processor - INFO - Processed 1030000/1165029 samples, kept 991940 after filtering
[Rank 3] 2025-09-07 14:31:57,539 - mamba_training.data.dataset_processor - INFO - Processed 1040000/1165029 samples, kept 1001472 after filtering
[Rank 3] 2025-09-07 14:32:01,976 - mamba_training.data.dataset_processor - INFO - Processed 1050000/1165029 samples, kept 1011081 after filtering
[Rank 3] 2025-09-07 14:32:06,308 - mamba_training.data.dataset_processor - INFO - Processed 1060000/1165029 samples, kept 1020733 after filtering
[Rank 3] 2025-09-07 14:32:10,873 - mamba_training.data.dataset_processor - INFO - Processed 1070000/1165029 samples, kept 1030323 after filtering
[Rank 3] 2025-09-07 14:32:15,123 - mamba_training.data.dataset_processor - INFO - Processed 1080000/1165029 samples, kept 1039987 after filtering
[Rank 3] 2025-09-07 14:32:19,641 - mamba_training.data.dataset_processor - INFO - Processed 1090000/1165029 samples, kept 1049627 after filtering
[Rank 3] 2025-09-07 14:32:24,331 - mamba_training.data.dataset_processor - INFO - Processed 1100000/1165029 samples, kept 1059291 after filtering
[Rank 3] 2025-09-07 14:32:28,829 - mamba_training.data.dataset_processor - INFO - Processed 1110000/1165029 samples, kept 1068900 after filtering
[Rank 3] 2025-09-07 14:32:33,251 - mamba_training.data.dataset_processor - INFO - Processed 1120000/1165029 samples, kept 1078513 after filtering
[Rank 3] 2025-09-07 14:32:37,692 - mamba_training.data.dataset_processor - INFO - Processed 1130000/1165029 samples, kept 1088175 after filtering
[Rank 3] 2025-09-07 14:32:42,210 - mamba_training.data.dataset_processor - INFO - Processed 1140000/1165029 samples, kept 1097844 after filtering
[Rank 3] 2025-09-07 14:32:46,494 - mamba_training.data.dataset_processor - INFO - Processed 1150000/1165029 samples, kept 1107417 after filtering
[Rank 3] 2025-09-07 14:32:51,078 - mamba_training.data.dataset_processor - INFO - Processed 1160000/1165029 samples, kept 1117081 after filtering
[Rank 3] 2025-09-07 14:32:53,335 - mamba_training.data.dataset_processor - INFO - Dataset processing complete. Kept 1121923/1165029 samples (96.3%)
[Rank 3] 2025-09-07 14:32:54,377 - root - INFO - Created datasets: train=1009730, val=112193
[Rank 3] 2025-09-07 14:33:04,113 - mamba_training.data.data_loader - INFO - Packed 1009730 samples into 640586 chunks (efficiency: 1.58x)
[Rank 3] 2025-09-07 14:33:29,439 - mamba_training.data.data_loader - INFO - Created MambaDataLoader with 640586 samples, batch_size=1, num_workers=4
[Rank 3] 2025-09-07 14:33:32,828 - mamba_training.data.data_loader - INFO - Created MambaDataLoader with 112193 samples, batch_size=1, num_workers=4
[Rank 3] 2025-09-07 14:33:32,828 - root - INFO - Creating Mamba model...
[Rank 3] 2025-09-07 14:33:33,236 - mamba_training.training.distributed_trainer - INFO - Using device: cuda:3
[Rank 3] 2025-09-07 14:33:33,254 - mamba_training.training.distributed_trainer - INFO - Using DDP for distributed training
[Rank 3] 2025-09-07 14:33:41,202 - mamba_training.training.optimization - INFO - Initialized OptimizationManager with lr=0.0001, weight_decay=0.1, warmup_steps=1000
[Rank 3] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Initialized DistributedTrainer on rank 3/4
[Rank 3] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Total training steps: 7506
[Rank 3] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Starting training...
[Rank 3] 2025-09-08 23:24:01,219 - mamba_training.training.distributed_trainer - INFO - Training completed in 118220.02 seconds
