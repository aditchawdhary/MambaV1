[Rank 2] 2025-09-07 14:24:29,158 - root - INFO - Creating datasets...
[Rank 2] 2025-09-07 14:24:29,585 - mamba_training.data.dataset_processor - INFO - Initialized DatasetProcessor with tokenizer vocab size: 50257
[Rank 2] 2025-09-07 14:24:29,585 - mamba_training.data.dataset_processor - INFO - Processing dataset: data/train.txt
[Rank 2] 2025-09-07 14:24:43,496 - mamba_training.data.dataset_processor - INFO - Processed 10000/1165029 samples, kept 9622 after filtering
[Rank 2] 2025-09-07 14:24:47,164 - mamba_training.data.dataset_processor - INFO - Processed 20000/1165029 samples, kept 19231 after filtering
[Rank 2] 2025-09-07 14:24:51,049 - mamba_training.data.dataset_processor - INFO - Processed 30000/1165029 samples, kept 28968 after filtering
[Rank 2] 2025-09-07 14:24:54,276 - mamba_training.data.dataset_processor - INFO - Processed 40000/1165029 samples, kept 38465 after filtering
[Rank 2] 2025-09-07 14:24:58,069 - mamba_training.data.dataset_processor - INFO - Processed 50000/1165029 samples, kept 48076 after filtering
[Rank 2] 2025-09-07 14:25:01,559 - mamba_training.data.dataset_processor - INFO - Processed 60000/1165029 samples, kept 57640 after filtering
[Rank 2] 2025-09-07 14:25:05,089 - mamba_training.data.dataset_processor - INFO - Processed 70000/1165029 samples, kept 67228 after filtering
[Rank 2] 2025-09-07 14:25:08,962 - mamba_training.data.dataset_processor - INFO - Processed 80000/1165029 samples, kept 76793 after filtering
[Rank 2] 2025-09-07 14:25:12,356 - mamba_training.data.dataset_processor - INFO - Processed 90000/1165029 samples, kept 86394 after filtering
[Rank 2] 2025-09-07 14:25:15,954 - mamba_training.data.dataset_processor - INFO - Processed 100000/1165029 samples, kept 95979 after filtering
[Rank 2] 2025-09-07 14:25:19,547 - mamba_training.data.dataset_processor - INFO - Processed 110000/1165029 samples, kept 105635 after filtering
[Rank 2] 2025-09-07 14:25:23,954 - mamba_training.data.dataset_processor - INFO - Processed 120000/1165029 samples, kept 115334 after filtering
[Rank 2] 2025-09-07 14:25:27,520 - mamba_training.data.dataset_processor - INFO - Processed 130000/1165029 samples, kept 124870 after filtering
[Rank 2] 2025-09-07 14:25:31,261 - mamba_training.data.dataset_processor - INFO - Processed 140000/1165029 samples, kept 134494 after filtering
[Rank 2] 2025-09-07 14:25:35,013 - mamba_training.data.dataset_processor - INFO - Processed 150000/1165029 samples, kept 144193 after filtering
[Rank 2] 2025-09-07 14:25:39,073 - mamba_training.data.dataset_processor - INFO - Processed 160000/1165029 samples, kept 153750 after filtering
[Rank 2] 2025-09-07 14:25:42,711 - mamba_training.data.dataset_processor - INFO - Processed 170000/1165029 samples, kept 163318 after filtering
[Rank 2] 2025-09-07 14:25:46,454 - mamba_training.data.dataset_processor - INFO - Processed 180000/1165029 samples, kept 173033 after filtering
[Rank 2] 2025-09-07 14:25:50,174 - mamba_training.data.dataset_processor - INFO - Processed 190000/1165029 samples, kept 182666 after filtering
[Rank 2] 2025-09-07 14:25:53,865 - mamba_training.data.dataset_processor - INFO - Processed 200000/1165029 samples, kept 192236 after filtering
[Rank 2] 2025-09-07 14:25:58,340 - mamba_training.data.dataset_processor - INFO - Processed 210000/1165029 samples, kept 201736 after filtering
[Rank 2] 2025-09-07 14:26:02,231 - mamba_training.data.dataset_processor - INFO - Processed 220000/1165029 samples, kept 211399 after filtering
[Rank 2] 2025-09-07 14:26:06,009 - mamba_training.data.dataset_processor - INFO - Processed 230000/1165029 samples, kept 220981 after filtering
[Rank 2] 2025-09-07 14:26:09,798 - mamba_training.data.dataset_processor - INFO - Processed 240000/1165029 samples, kept 230594 after filtering
[Rank 2] 2025-09-07 14:26:13,656 - mamba_training.data.dataset_processor - INFO - Processed 250000/1165029 samples, kept 240303 after filtering
[Rank 2] 2025-09-07 14:26:17,482 - mamba_training.data.dataset_processor - INFO - Processed 260000/1165029 samples, kept 249958 after filtering
[Rank 2] 2025-09-07 14:26:21,617 - mamba_training.data.dataset_processor - INFO - Processed 270000/1165029 samples, kept 259684 after filtering
[Rank 2] 2025-09-07 14:26:26,353 - mamba_training.data.dataset_processor - INFO - Processed 280000/1165029 samples, kept 269253 after filtering
[Rank 2] 2025-09-07 14:26:30,252 - mamba_training.data.dataset_processor - INFO - Processed 290000/1165029 samples, kept 278985 after filtering
[Rank 2] 2025-09-07 14:26:34,231 - mamba_training.data.dataset_processor - INFO - Processed 300000/1165029 samples, kept 288595 after filtering
[Rank 2] 2025-09-07 14:26:38,120 - mamba_training.data.dataset_processor - INFO - Processed 310000/1165029 samples, kept 298307 after filtering
[Rank 2] 2025-09-07 14:26:42,001 - mamba_training.data.dataset_processor - INFO - Processed 320000/1165029 samples, kept 307919 after filtering
[Rank 2] 2025-09-07 14:26:45,878 - mamba_training.data.dataset_processor - INFO - Processed 330000/1165029 samples, kept 317462 after filtering
[Rank 2] 2025-09-07 14:26:49,772 - mamba_training.data.dataset_processor - INFO - Processed 340000/1165029 samples, kept 327094 after filtering
[Rank 2] 2025-09-07 14:26:53,779 - mamba_training.data.dataset_processor - INFO - Processed 350000/1165029 samples, kept 336748 after filtering
[Rank 2] 2025-09-07 14:26:58,873 - mamba_training.data.dataset_processor - INFO - Processed 360000/1165029 samples, kept 346382 after filtering
[Rank 2] 2025-09-07 14:27:02,902 - mamba_training.data.dataset_processor - INFO - Processed 370000/1165029 samples, kept 355986 after filtering
[Rank 2] 2025-09-07 14:27:06,872 - mamba_training.data.dataset_processor - INFO - Processed 380000/1165029 samples, kept 365573 after filtering
[Rank 2] 2025-09-07 14:27:10,855 - mamba_training.data.dataset_processor - INFO - Processed 390000/1165029 samples, kept 375162 after filtering
[Rank 2] 2025-09-07 14:27:14,790 - mamba_training.data.dataset_processor - INFO - Processed 400000/1165029 samples, kept 384871 after filtering
[Rank 2] 2025-09-07 14:27:18,514 - mamba_training.data.dataset_processor - INFO - Processed 410000/1165029 samples, kept 394482 after filtering
[Rank 2] 2025-09-07 14:27:22,508 - mamba_training.data.dataset_processor - INFO - Processed 420000/1165029 samples, kept 404082 after filtering
[Rank 2] 2025-09-07 14:27:26,470 - mamba_training.data.dataset_processor - INFO - Processed 430000/1165029 samples, kept 413708 after filtering
[Rank 2] 2025-09-07 14:27:30,415 - mamba_training.data.dataset_processor - INFO - Processed 440000/1165029 samples, kept 423368 after filtering
[Rank 2] 2025-09-07 14:27:34,466 - mamba_training.data.dataset_processor - INFO - Processed 450000/1165029 samples, kept 433059 after filtering
[Rank 2] 2025-09-07 14:27:38,560 - mamba_training.data.dataset_processor - INFO - Processed 460000/1165029 samples, kept 442746 after filtering
[Rank 2] 2025-09-07 14:27:44,190 - mamba_training.data.dataset_processor - INFO - Processed 470000/1165029 samples, kept 452463 after filtering
[Rank 2] 2025-09-07 14:27:48,254 - mamba_training.data.dataset_processor - INFO - Processed 480000/1165029 samples, kept 462035 after filtering
[Rank 2] 2025-09-07 14:27:52,477 - mamba_training.data.dataset_processor - INFO - Processed 490000/1165029 samples, kept 471662 after filtering
[Rank 2] 2025-09-07 14:27:56,653 - mamba_training.data.dataset_processor - INFO - Processed 500000/1165029 samples, kept 481361 after filtering
[Rank 2] 2025-09-07 14:28:00,746 - mamba_training.data.dataset_processor - INFO - Processed 510000/1165029 samples, kept 490932 after filtering
[Rank 2] 2025-09-07 14:28:04,887 - mamba_training.data.dataset_processor - INFO - Processed 520000/1165029 samples, kept 500606 after filtering
[Rank 2] 2025-09-07 14:28:09,004 - mamba_training.data.dataset_processor - INFO - Processed 530000/1165029 samples, kept 510144 after filtering
[Rank 2] 2025-09-07 14:28:13,195 - mamba_training.data.dataset_processor - INFO - Processed 540000/1165029 samples, kept 519767 after filtering
[Rank 2] 2025-09-07 14:28:17,395 - mamba_training.data.dataset_processor - INFO - Processed 550000/1165029 samples, kept 529444 after filtering
[Rank 2] 2025-09-07 14:28:21,565 - mamba_training.data.dataset_processor - INFO - Processed 560000/1165029 samples, kept 539176 after filtering
[Rank 2] 2025-09-07 14:28:25,649 - mamba_training.data.dataset_processor - INFO - Processed 570000/1165029 samples, kept 548802 after filtering
[Rank 2] 2025-09-07 14:28:29,832 - mamba_training.data.dataset_processor - INFO - Processed 580000/1165029 samples, kept 558421 after filtering
[Rank 2] 2025-09-07 14:28:35,896 - mamba_training.data.dataset_processor - INFO - Processed 590000/1165029 samples, kept 568107 after filtering
[Rank 2] 2025-09-07 14:28:40,100 - mamba_training.data.dataset_processor - INFO - Processed 600000/1165029 samples, kept 577706 after filtering
[Rank 2] 2025-09-07 14:28:44,493 - mamba_training.data.dataset_processor - INFO - Processed 610000/1165029 samples, kept 587413 after filtering
[Rank 2] 2025-09-07 14:28:48,552 - mamba_training.data.dataset_processor - INFO - Processed 620000/1165029 samples, kept 597049 after filtering
[Rank 2] 2025-09-07 14:28:52,632 - mamba_training.data.dataset_processor - INFO - Processed 630000/1165029 samples, kept 606630 after filtering
[Rank 2] 2025-09-07 14:28:56,776 - mamba_training.data.dataset_processor - INFO - Processed 640000/1165029 samples, kept 616299 after filtering
[Rank 2] 2025-09-07 14:29:00,817 - mamba_training.data.dataset_processor - INFO - Processed 650000/1165029 samples, kept 625979 after filtering
[Rank 2] 2025-09-07 14:29:04,963 - mamba_training.data.dataset_processor - INFO - Processed 660000/1165029 samples, kept 635616 after filtering
[Rank 2] 2025-09-07 14:29:09,204 - mamba_training.data.dataset_processor - INFO - Processed 670000/1165029 samples, kept 645220 after filtering
[Rank 2] 2025-09-07 14:29:13,310 - mamba_training.data.dataset_processor - INFO - Processed 680000/1165029 samples, kept 654810 after filtering
[Rank 2] 2025-09-07 14:29:17,373 - mamba_training.data.dataset_processor - INFO - Processed 690000/1165029 samples, kept 664376 after filtering
[Rank 2] 2025-09-07 14:29:21,543 - mamba_training.data.dataset_processor - INFO - Processed 700000/1165029 samples, kept 673978 after filtering
[Rank 2] 2025-09-07 14:29:25,774 - mamba_training.data.dataset_processor - INFO - Processed 710000/1165029 samples, kept 683595 after filtering
[Rank 2] 2025-09-07 14:29:29,929 - mamba_training.data.dataset_processor - INFO - Processed 720000/1165029 samples, kept 693245 after filtering
[Rank 2] 2025-09-07 14:29:34,083 - mamba_training.data.dataset_processor - INFO - Processed 730000/1165029 samples, kept 702933 after filtering
[Rank 2] 2025-09-07 14:29:38,479 - mamba_training.data.dataset_processor - INFO - Processed 740000/1165029 samples, kept 712617 after filtering
[Rank 2] 2025-09-07 14:29:42,943 - mamba_training.data.dataset_processor - INFO - Processed 750000/1165029 samples, kept 722325 after filtering
[Rank 2] 2025-09-07 14:29:49,730 - mamba_training.data.dataset_processor - INFO - Processed 760000/1165029 samples, kept 731886 after filtering
[Rank 2] 2025-09-07 14:29:54,061 - mamba_training.data.dataset_processor - INFO - Processed 770000/1165029 samples, kept 741563 after filtering
[Rank 2] 2025-09-07 14:29:58,251 - mamba_training.data.dataset_processor - INFO - Processed 780000/1165029 samples, kept 751172 after filtering
[Rank 2] 2025-09-07 14:30:02,442 - mamba_training.data.dataset_processor - INFO - Processed 790000/1165029 samples, kept 760827 after filtering
[Rank 2] 2025-09-07 14:30:06,692 - mamba_training.data.dataset_processor - INFO - Processed 800000/1165029 samples, kept 770488 after filtering
[Rank 2] 2025-09-07 14:30:11,037 - mamba_training.data.dataset_processor - INFO - Processed 810000/1165029 samples, kept 780084 after filtering
[Rank 2] 2025-09-07 14:30:15,174 - mamba_training.data.dataset_processor - INFO - Processed 820000/1165029 samples, kept 789704 after filtering
[Rank 2] 2025-09-07 14:30:19,443 - mamba_training.data.dataset_processor - INFO - Processed 830000/1165029 samples, kept 799332 after filtering
[Rank 2] 2025-09-07 14:30:23,677 - mamba_training.data.dataset_processor - INFO - Processed 840000/1165029 samples, kept 808962 after filtering
[Rank 2] 2025-09-07 14:30:27,977 - mamba_training.data.dataset_processor - INFO - Processed 850000/1165029 samples, kept 818600 after filtering
[Rank 2] 2025-09-07 14:30:32,184 - mamba_training.data.dataset_processor - INFO - Processed 860000/1165029 samples, kept 828238 after filtering
[Rank 2] 2025-09-07 14:30:36,594 - mamba_training.data.dataset_processor - INFO - Processed 870000/1165029 samples, kept 837922 after filtering
[Rank 2] 2025-09-07 14:30:41,052 - mamba_training.data.dataset_processor - INFO - Processed 880000/1165029 samples, kept 847636 after filtering
[Rank 2] 2025-09-07 14:30:45,648 - mamba_training.data.dataset_processor - INFO - Processed 890000/1165029 samples, kept 857288 after filtering
[Rank 2] 2025-09-07 14:30:49,993 - mamba_training.data.dataset_processor - INFO - Processed 900000/1165029 samples, kept 866875 after filtering
[Rank 2] 2025-09-07 14:30:54,369 - mamba_training.data.dataset_processor - INFO - Processed 910000/1165029 samples, kept 876486 after filtering
[Rank 2] 2025-09-07 14:30:58,720 - mamba_training.data.dataset_processor - INFO - Processed 920000/1165029 samples, kept 886110 after filtering
[Rank 2] 2025-09-07 14:31:02,962 - mamba_training.data.dataset_processor - INFO - Processed 930000/1165029 samples, kept 895602 after filtering
[Rank 2] 2025-09-07 14:31:07,364 - mamba_training.data.dataset_processor - INFO - Processed 940000/1165029 samples, kept 905266 after filtering
[Rank 2] 2025-09-07 14:31:11,809 - mamba_training.data.dataset_processor - INFO - Processed 950000/1165029 samples, kept 914889 after filtering
[Rank 2] 2025-09-07 14:31:19,491 - mamba_training.data.dataset_processor - INFO - Processed 960000/1165029 samples, kept 924532 after filtering
[Rank 2] 2025-09-07 14:31:23,881 - mamba_training.data.dataset_processor - INFO - Processed 970000/1165029 samples, kept 934151 after filtering
[Rank 2] 2025-09-07 14:31:28,316 - mamba_training.data.dataset_processor - INFO - Processed 980000/1165029 samples, kept 943783 after filtering
[Rank 2] 2025-09-07 14:31:32,954 - mamba_training.data.dataset_processor - INFO - Processed 990000/1165029 samples, kept 953434 after filtering
[Rank 2] 2025-09-07 14:31:37,063 - mamba_training.data.dataset_processor - INFO - Processed 1000000/1165029 samples, kept 963005 after filtering
[Rank 2] 2025-09-07 14:31:41,370 - mamba_training.data.dataset_processor - INFO - Processed 1010000/1165029 samples, kept 972675 after filtering
[Rank 2] 2025-09-07 14:31:45,661 - mamba_training.data.dataset_processor - INFO - Processed 1020000/1165029 samples, kept 982298 after filtering
[Rank 2] 2025-09-07 14:31:50,026 - mamba_training.data.dataset_processor - INFO - Processed 1030000/1165029 samples, kept 991940 after filtering
[Rank 2] 2025-09-07 14:31:54,320 - mamba_training.data.dataset_processor - INFO - Processed 1040000/1165029 samples, kept 1001472 after filtering
[Rank 2] 2025-09-07 14:31:58,778 - mamba_training.data.dataset_processor - INFO - Processed 1050000/1165029 samples, kept 1011081 after filtering
[Rank 2] 2025-09-07 14:32:03,116 - mamba_training.data.dataset_processor - INFO - Processed 1060000/1165029 samples, kept 1020733 after filtering
[Rank 2] 2025-09-07 14:32:07,698 - mamba_training.data.dataset_processor - INFO - Processed 1070000/1165029 samples, kept 1030323 after filtering
[Rank 2] 2025-09-07 14:32:11,921 - mamba_training.data.dataset_processor - INFO - Processed 1080000/1165029 samples, kept 1039987 after filtering
[Rank 2] 2025-09-07 14:32:16,392 - mamba_training.data.dataset_processor - INFO - Processed 1090000/1165029 samples, kept 1049627 after filtering
[Rank 2] 2025-09-07 14:32:21,117 - mamba_training.data.dataset_processor - INFO - Processed 1100000/1165029 samples, kept 1059291 after filtering
[Rank 2] 2025-09-07 14:32:25,652 - mamba_training.data.dataset_processor - INFO - Processed 1110000/1165029 samples, kept 1068900 after filtering
[Rank 2] 2025-09-07 14:32:30,117 - mamba_training.data.dataset_processor - INFO - Processed 1120000/1165029 samples, kept 1078513 after filtering
[Rank 2] 2025-09-07 14:32:34,502 - mamba_training.data.dataset_processor - INFO - Processed 1130000/1165029 samples, kept 1088175 after filtering
[Rank 2] 2025-09-07 14:32:39,020 - mamba_training.data.dataset_processor - INFO - Processed 1140000/1165029 samples, kept 1097844 after filtering
[Rank 2] 2025-09-07 14:32:43,309 - mamba_training.data.dataset_processor - INFO - Processed 1150000/1165029 samples, kept 1107417 after filtering
[Rank 2] 2025-09-07 14:32:47,796 - mamba_training.data.dataset_processor - INFO - Processed 1160000/1165029 samples, kept 1117081 after filtering
[Rank 2] 2025-09-07 14:32:50,131 - mamba_training.data.dataset_processor - INFO - Dataset processing complete. Kept 1121923/1165029 samples (96.3%)
[Rank 2] 2025-09-07 14:32:51,110 - root - INFO - Created datasets: train=1009730, val=112193
[Rank 2] 2025-09-07 14:33:00,904 - mamba_training.data.data_loader - INFO - Packed 1009730 samples into 640586 chunks (efficiency: 1.58x)
[Rank 2] 2025-09-07 14:33:27,180 - mamba_training.data.data_loader - INFO - Created MambaDataLoader with 640586 samples, batch_size=1, num_workers=4
[Rank 2] 2025-09-07 14:33:30,663 - mamba_training.data.data_loader - INFO - Created MambaDataLoader with 112193 samples, batch_size=1, num_workers=4
[Rank 2] 2025-09-07 14:33:30,663 - root - INFO - Creating Mamba model...
[Rank 2] 2025-09-07 14:33:31,063 - mamba_training.training.distributed_trainer - INFO - Using device: cuda:2
[Rank 2] 2025-09-07 14:33:31,075 - mamba_training.training.distributed_trainer - INFO - Using DDP for distributed training
[Rank 2] 2025-09-07 14:33:41,201 - mamba_training.training.optimization - INFO - Initialized OptimizationManager with lr=0.0001, weight_decay=0.1, warmup_steps=1000
[Rank 2] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Initialized DistributedTrainer on rank 2/4
[Rank 2] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Total training steps: 7506
[Rank 2] 2025-09-07 14:33:41,202 - mamba_training.training.distributed_trainer - INFO - Starting training...
[Rank 2] 2025-09-08 23:24:01,219 - mamba_training.training.distributed_trainer - INFO - Training completed in 118220.02 seconds
